@model UtilitiesHR.Models.JenisBarang
<form id="jenis-form" method="post" action="/JenisBarangs/Create">
    @Html.AntiForgeryToken()
    <div class="row g-3">
        <div class="col-md-7">
            <label class="form-label">Nama Jenis</label>
            <input asp-for="Nama" class="form-control" />
            <span asp-validation-for="Nama" class="text-danger small"></span>
        </div>
        <div class="col-md-5">
            <label class="form-label">Keterangan</label>
            <input asp-for="Keterangan" class="form-control" />
        </div>
    </div>
    <div class="d-flex justify-content-end gap-2 mt-4">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Batal</button>
        <button type="submit" class="btn btn-primary">Simpan</button>
    </div>
</form>

<script>
    (function(){
        const $form = $('#jenis-form');
        $form.on('submit', function(e){
            e.preventDefault();
            $.ajax({
                url: $form.attr('action'), method:'POST',
                data: $form.serialize(),
                headers: { 'RequestVerificationToken': $form.find('input[name="__RequestVerificationToken"]').val() }
            })
            .done(function(resp){
                if(resp?.ok){
                    Swal.fire({icon:'success',title:'Berhasil',text:'Jenis barang ditambahkan.'});
                    // refresh dropdown di form Material jika ada
                    $.get('/JenisBarangs/ListJson', function(items){
                        const $sel = $('select[name="JenisBarangId"]');
                        if ($sel.length){
                            $sel.empty();
                            items.forEach(x => $sel.append(new Option(x.nama || x.Nama, x.id || x.Id)));
                            $sel.val(resp.id);
                        }
                    });
                    $('#ajax-modal').modal('hide');
                }else{
                    $('#ajax-modal .modal-body').html(resp); // render ulang partial jika invalid
                }
            })
            .fail(()=> Swal.fire({icon:'error',title:'Gagal',text:'Tidak dapat menyimpan.'}));
        });
    })();
</script>
